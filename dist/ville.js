!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("VILLE",[],n):"object"==typeof exports?exports.VILLE=n():t.VILLE=n()}(window,function(){return function(t){var n={};function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}return e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)e.d(o,i,function(n){return t[n]}.bind(null,i));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";e.r(n);let o=[],i=[],r=0;function u(t){if("function"!=typeof t)throw new TypeError("A thread only acceps a 'generator function' as an argument");if(!(t=t())||!t.next)throw new TypeError("A thread only acceps a 'generator function' as an argument");let n={job:t,priority:0,id:r++,cancel:!1};return i.push(n),{cancel:function(){n.cancel=!0},priority:function(t){return n.priority=t,this}}}function c(t){t.sort((t,n)=>t.priority===n.priority?n.id-t.id:n.priority-t.priority);for(let n=t.length-1;n>=0;n--)(t[n].cancel||t[n].job.next().done)&&t.splice(n,1)}let l=[];function f(t){return l[l.length-1].add(t)}function s(t){let n=[];return l.push({add:t=>(n.push(t),t)}),t(),l.pop(),n}function d(){return l.length>0}function a(t){let n=1,e=!1,o=!1,i=function*(){for(let i=0;i<n;i++){let i=s(t);for(let t of i){if(o)return void(e=!0);for(let n of t()){if(o)return void(e=!0);yield}}n>1&&(yield)}e=!0};return d()?f(function*(){yield*i()}):u(function*(){yield*i()}),{cancel:function(){f(function*(){o=!0})},completed:function(){return e},repeat:function(t=Number.MAX_VALUE){return n=t,this}}}let h={};function p(){return m/1e3}h.init=((t={})=>{let{width:n=800,height:e=600,autoscale:o=!0}=t;h.renderer=PIXI.autoDetectRenderer({width:n,height:e}),h.root=new PIXI.Container,document.body.appendChild(h.renderer.view),o&&(window.onresize=(()=>{h.renderer.resize(window.innerWidth,window.innerHeight),h.root.position.set(window.innerWidth/2,window.innerHeight/2),h.root.scale.set(Math.min(window.innerWidth/n,window.innerHeight/e))}),window.onresize())}),h.load=(t=>{fetch("assets.json").then(t=>{if(t.ok)return t.json()}).then(n=>{Object.assign(h,n);for(let t in n)PIXI.loader.add(t,n[t]);PIXI.loader.load(()=>{t&&a(t)})})}),h.render=(()=>{h.renderer&&h.renderer.render(h.root)});let y=0,m=0;function w(t){let n;return(n=t?PIXI.loader.resources[t]?new PIXI.Sprite(PIXI.loader.resources[t].texture):new PIXI.Sprite.fromImage(t):new PIXI.Sprite).anchor.set(.5),f(function*(){h.root.addChild(n)}),n}function x(t){let n=new PIXI.Text(t,{fontFamily:"Helvetica",fontSize:36,fill:16777215,align:"center"});return n.anchor.set(.5),f(function*(){h.root.addChild(n)}),n}function b(t){f(function*(){t.parent&&t.parent.removeChild(t)})}function g(t){let n=Number.MAX_VALUE,e=!1,o=!1;return f(function*(){for(let i=0;i<n;i++){if(o)return void(e=!0);let n=s(t);for(let t of n)yield*t();yield}e=!0}),{cancel:function(){f(function*(){o=!0})},stop:function(){f(function*(){_stop=!0})},completed:function(){return e},times:function(t){n=t}}}function v(t){return{down:n=>{let e;return f(function*(){e=j(t,"down",n)}),{cancel:()=>{f(function*(){M(t,"down",e)})}}},up:n=>{let e;return f(function*(){e=j(t,"up",n)}),{cancel:()=>{f(function*(){M(t,"up",e)})}}},repeat:n=>{let e,o;return f(function*(){let i;e=j(t,"down",()=>{i=g(n)}),o=j(t,"up",()=>{i.cancel()})}),{cancel:()=>{f(function*(){M(t,"down",e),M(t,"up",o)})}}}}}requestAnimationFrame(function t(n){m=n-y,y=n,function(){if(i.length>0){for(let t=0;t<i.length;t++)o.push(i[t]);i=[]}c(o),c(i)}(),h.render(),requestAnimationFrame(t)});let I={down:{},up:{}};function j(t,n,e){let o;t=t.toLowerCase(),I[n][t]||(I[n][t]=[]);let i=()=>{o&&!o.completed()||(o=a(e))};return I[n][t].push(i),i}function M(t,n,e){if(t=t.toLowerCase(),!I[n][t])return;let o=I[n][t].indexOf(e);I[n][t].splice(o,1)}document.addEventListener("keydown",t=>{let n=t.key.toLowerCase();I.down[n]&&0!==I.down[n].length&&I.down[n].slice(-1)[0]()}),document.addEventListener("keyup",t=>{let n=t.key.toLowerCase();I.up[n]&&0!==I.up[n].length&&I.up[n].slice(-1)[0]()});class P{constructor(t=0,n=0){this.x=t,this.y=n}dot(t){return this.x*t.x+this.y*t.y}neg(){return this.x=-this.x,this.y=-this.y,this}mul(t){return this.x*=t,this.y*=t,this}add(t){return this.x+=t.x,this.y+=t.y,this}sub(t){return this.x-=t.x,this.y-=t.y,this}set(t,n){return this.x=t,this.y=n,this}}function _(t,n){return new P(t,n)}class L{constructor(t){this.points=t}project(t){let n=this.points[0].dot(t),e=n,o=n;for(let i=1;i<this.points.length;i++)n=this.points[i].dot(t),e=Math.min(n,e),o=Math.max(n,o);return new X(e,o)}}class X{constructor(t,n){this.min=t,this.max=n}overlap(t){return this.min<t.min?t.min-this.max:this.min-t.max}}function A(t,n){let e=[_(0,1),_(1,0)],o=Number.MAX_VALUE,i=_(),r=new L(t.points),u=new L(n.points);for(let t of e){let n=r.project(t),e=u.project(t);if(n.overlap(e)>=0)return;Math.abs(n.overlap(e))<o&&(o=Math.abs(n.overlap(e)),i=t)}return t.center.sub(n.center).dot(i)<0&&i.neg(),i.mul(o)}function E(t){let n,e=!1,o=0;return f(function*(){e||(n=u(function*(){let n=s(t);for(let t of n)yield*t()})).priority(o)}),{cancel:function(){n&&n.cancel(),e=!0},priority:function(t){return n&&n.priority(t),o=t,this}}}let C={};function S(t=[{a:"",b:""}]){let n=E(()=>{g(()=>{let n=function(){let t={};for(let n in C){t[n]=[];for(let e=C[n].length-1;e>=0;e--){let o=C[n][e];!0!==o.destroyed?t[n].push({object:o.object(),center:o.center(),points:o.points(),collision:o.collision}):C[n].splice(e,1)}}return t}();for(let e of t)T(n[e.a],n[e.b])})}).priority(100);return{cancel:()=>{n.cancel()}}}function T(t,n){if(t&&n)for(let e=0;e<t.length;e++)for(let o=t===n?e+1:0;o<n.length;o++){if(t[e]===n[o])continue;let i=A(t[e],n[o]);i&&(E(()=>{t[e].collision(n[o].object,i)}),E(()=>{n[o].collision(t[e].object,i.neg())}))}}function O(t){let n,e,o,i,r,u,c=!1;function l(){i&&t.removeChild(i);let n=function(){if(e&&o)return new PIXI.Rectangle(e/-2,o/-2,e,o);return t.getLocalBounds()}();(i=new PIXI.Graphics(!0)).visible=c,i.lineStyle(c?1e-4:0,16711680,.8),i.moveTo(n.left,n.top).lineTo(n.right,n.top).lineTo(n.right,n.bottom).lineTo(n.left,n.bottom).lineTo(n.left,n.top),t.addChild(i)}return f(function*(){l(),function(t){let n=t.group()||"";C[n]||(C[n]=[]),C[n].push(t)}(u)}),u={type:function(){return"aabb"},group:function(t){return void 0!==t?(r=t,this):r},center:function(){let{x:n,y:e}=t.getGlobalPosition();return _(n,e)},object:function(){return t},handle:function(t){return n=t,this},points:function(){let t=i.getBounds();return[_(t.left,t.top),_(t.right,t.bottom),_(t.right,t.top),_(t.left,t.bottom)]},size:function(t,n){return e=t,o=n,f(function*(){l()}),this},show:function(){return c=!0,f(function*(){l()}),this},collision:function(t,e){n&&n(t,e)},destroy:function(){this.destroyed=!0}}}function V(t=Number.MAX_VALUE){let n=!1;return f(function*(){let e=0;for(;e<t&&!n;)e+=p(),yield}),{cancel:()=>{f(function*(){n=!0})}}}function k(t){let n=1,e=!1,o=!1,i=function*(){for(let i=0;i<n;i++){let n=s(t);n.reverse();for(let t=0;t<n.length;t++)n[t]=n[t]();for(;n.length>0;){for(let t=n.length-1;t>=0;t--){if(o)return void(e=!0);n[t].next().done&&n.splice(t,1)}yield}}e=!0};return d()?f(function*(){yield*i()}):u(function*(){yield*i()}),{cancel:()=>{f(function*(){o=!0})},completed:()=>e,repeat:(t=Number.MAX_VALUE)=>(n=t,this)}}const z={};function N(t){let n=z.linear,e={},o=0;return f(function*(){let i={};for(let n in e)i[n]=t[n];let r=0;for(;r<o&&o>0;){r+=p();for(let u in i)t[u]=U(i[u],e[u],Math.min(1,r/o),n);yield}for(let n in i)t[n]=e[n]}),{to:function(t){return e=t,this},ease:function(t=z.sine_inout){return n=t,this},time:function(t){return o=t,this}}}function U(t,n,e,o){return t+(n-t)*o(e)}function H(t){let n={},e={},o=z.linear,i=0;return a(()=>{void 0===n.x&&void 0===n.y?(void 0!==e.x&&(e.x+=t.x),void 0!==e.y&&(e.y+=t.y),N(t).to(e).time(i).ease(o)):N(t).to(n).time(i).ease(o)}),{to:function(t){return void 0!==t.x&&(n.x=t.x),void 0!==t.y&&(n.y=t.y),this},by:function(t){return void 0!==t.x&&(e.x=t.x),void 0!==t.y&&(e.y=t.y),this},ease:function(t=z.sine_inout){return o=t,this},time:function(t){return i=t,this}}}z.linear=(t=>t),z.sine_in=(t=>-1*Math.cos(t*(Math.PI/2))+1),z.sine_inout=(t=>-.5*(Math.cos(Math.PI*t)-1)),z.sine_out=(t=>Math.sin(t*(Math.PI/2)));const q=2*Math.PI/360;function F(t){let n,e,o=z.linear,i=0;return a(()=>{let r=t.rotation;void 0!==e&&(r=t.rotation+e*q),void 0!==n&&(r=n*q),N(t).to({rotation:r}).time(i).ease(o)}),{to:function(t){return n=t,this},by:function(t){return e=t,this},ease:function(t=z.sine_inout){return o=t,this},time:function(t){return i=t,this}}}function W(t){let n={},e={},o=z.linear,i=0;return a(()=>{void 0===n.x&&void 0===n.y?(void 0!==e.x&&(e.x+=t.scale.x),void 0!==e.y&&(e.y+=t.scale.y),N(t.scale).to(e).time(i).ease(o)):N(t.scale).to(n).time(i).ease(o)}),{to:function(t){return"number"==typeof t?(n.x=t,n.y=t):(void 0!==t.x&&(n.x=t.x),void 0!==t.y&&(n.y=t.y)),this},by:function(t){return"number"==typeof t?(e.x=t,e.y=t):(void 0!==t.x&&(e.x=t.x),void 0!==t.y&&(e.y=t.y)),this},ease:function(t=z.sine_inout){return o=t,this},time:function(t){return i=t,this}}}function B(t){let n=0;return a(()=>{N(t).to({alpha:1}).time(n)}),{time:function(t){n=t}}}function G(t){let n=0;return a(()=>{N(t).to({alpha:0}).time(n)}),{time:function(t){n=t}}}function R(t){let n=!1;return f(function*(){let e=new Audio(t);e.onended=(()=>{n=!0}),e.play()}),{wait:function(){f(function*(){for(;!n;)yield})}}}e.d(n,"time",function(){return p}),e.d(n,"thread",function(){return u}),e.d(n,"game",function(){return h}),e.d(n,"sprite",function(){return w}),e.d(n,"text",function(){return x}),e.d(n,"remove",function(){return b}),e.d(n,"key",function(){return v}),e.d(n,"aabb",function(){return O}),e.d(n,"collision",function(){return S}),e.d(n,"wait",function(){return V}),e.d(n,"task",function(){return f}),e.d(n,"sequence",function(){return a}),e.d(n,"parallel",function(){return k}),e.d(n,"tween",function(){return N}),e.d(n,"ease",function(){return z}),e.d(n,"move",function(){return H}),e.d(n,"rotate",function(){return F}),e.d(n,"scale",function(){return W}),e.d(n,"show",function(){return B}),e.d(n,"hide",function(){return G}),e.d(n,"sound",function(){return R}),e.d(n,"proceed",function(){return E}),e.d(n,"repeat",function(){return g})}])});